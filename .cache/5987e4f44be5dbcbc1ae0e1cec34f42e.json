{"dependencies":[{"name":"/home/szamulko/Desktop/Projects/PacMan/package.json","includedInParent":true,"mtime":1528724217926},{"name":"/home/szamulko/Desktop/Projects/PacMan/node_modules/@tensorflow/tfjs-core/package.json","includedInParent":true,"mtime":1528724212618},{"name":"../environment","loc":{"line":36,"column":20}},{"name":"../util","loc":{"line":37,"column":23}},{"name":"./io_utils","loc":{"line":38,"column":70}},{"name":"./router_registry","loc":{"line":39,"column":33}},{"name":"./weights_loader","loc":{"line":40,"column":41}}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.httpRequestRouter = exports.BrowserHTTPRequest = undefined;\nexports.browserHTTPRequest = browserHTTPRequest;\n\nvar _environment = require(\"../environment\");\n\nvar _util = require(\"../util\");\n\nvar _io_utils = require(\"./io_utils\");\n\nvar _router_registry = require(\"./router_registry\");\n\nvar _weights_loader = require(\"./weights_loader\");\n\nvar __awaiter = undefined && undefined.__awaiter || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n            try {\n                step(generator.next(value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function rejected(value) {\n            try {\n                step(generator[\"throw\"](value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function step(result) {\n            result.done ? resolve(result.value) : new P(function (resolve) {\n                resolve(result.value);\n            }).then(fulfilled, rejected);\n        }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = undefined && undefined.__generator || function (thisArg, body) {\n    var _ = { label: 0, sent: function () {\n            if (t[0] & 1) throw t[1];return t[1];\n        }, trys: [], ops: [] },\n        f,\n        y,\n        t,\n        g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n    }), g;\n    function verb(n) {\n        return function (v) {\n            return step([n, v]);\n        };\n    }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0:case 1:\n                    t = op;break;\n                case 4:\n                    _.label++;return { value: op[1], done: false };\n                case 5:\n                    _.label++;y = op[1];op = [0];continue;\n                case 7:\n                    op = _.ops.pop();_.trys.pop();continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                        _ = 0;continue;\n                    }\n                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                        _.label = op[1];break;\n                    }\n                    if (op[0] === 6 && _.label < t[1]) {\n                        _.label = t[1];t = op;break;\n                    }\n                    if (t && _.label < t[2]) {\n                        _.label = t[2];_.ops.push(op);break;\n                    }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop();continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) {\n            op = [6, e];y = 0;\n        } finally {\n            f = t = 0;\n        }\n        if (op[0] & 5) throw op[1];return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\nvar BrowserHTTPRequest = function () {\n    function BrowserHTTPRequest(path, requestInit) {\n        this.DEFAULT_METHOD = 'POST';\n        if (!_environment.ENV.get('IS_BROWSER')) {\n            throw new Error('browserHTTPRequest is not supported outside the web browser.');\n        }\n        (0, _util.assert)(path != null && path.length > 0, 'URL path for browserHTTPRequest must not be null, undefined or ' + 'empty.');\n        this.path = path;\n        if (requestInit != null && requestInit.body != null) {\n            throw new Error('requestInit is expected to have no pre-existing body, but has one.');\n        }\n        this.requestInit = requestInit || {};\n    }\n    BrowserHTTPRequest.prototype.save = function (modelArtifacts) {\n        return __awaiter(this, void 0, void 0, function () {\n            var init, weightsManifest, modelTopologyAndWeightManifest, response;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (modelArtifacts.modelTopology instanceof ArrayBuffer) {\n                            throw new Error('BrowserHTTPRequest.save() does not support saving model topology ' + 'in binary formats yet.');\n                        }\n                        init = Object.assign({ method: this.DEFAULT_METHOD }, this.requestInit);\n                        init.body = new FormData();\n                        weightsManifest = [{\n                            paths: ['./model.weights.bin'],\n                            weights: modelArtifacts.weightSpecs\n                        }];\n                        modelTopologyAndWeightManifest = {\n                            modelTopology: modelArtifacts.modelTopology,\n                            weightsManifest: weightsManifest\n                        };\n                        init.body.append('model.json', new Blob([JSON.stringify(modelTopologyAndWeightManifest)], { type: 'application/json' }), 'model.json');\n                        if (modelArtifacts.weightData != null) {\n                            init.body.append('model.weights.bin', new Blob([modelArtifacts.weightData], { type: 'application/octet-stream' }), 'model.weights.bin');\n                        }\n                        return [4, fetch(this.path, init)];\n                    case 1:\n                        response = _a.sent();\n                        if (response.status === 200) {\n                            return [2, {\n                                modelArtifactsInfo: (0, _io_utils.getModelArtifactsInfoForJSON)(modelArtifacts),\n                                responses: [response]\n                            }];\n                        } else {\n                            throw new Error(\"BrowserHTTPRequest.save() failed due to HTTP response status \" + (response.status + \".\"));\n                        }\n                        return [2];\n                }\n            });\n        });\n    };\n    BrowserHTTPRequest.prototype.load = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var modelConfigRequest, modelConfig, modelTopology, weightsManifest, weightSpecs, weightData, weightsManifest_1, _i, weightsManifest_2, entry, pathPrefix_1, fetchURLs_1, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        return [4, fetch(this.path, this.requestInit)];\n                    case 1:\n                        modelConfigRequest = _b.sent();\n                        return [4, modelConfigRequest.json()];\n                    case 2:\n                        modelConfig = _b.sent();\n                        modelTopology = modelConfig['modelTopology'];\n                        weightsManifest = modelConfig['weightsManifest'];\n                        if (modelTopology == null && weightsManifest == null) {\n                            throw new Error(\"The JSON from HTTP path \" + this.path + \" contains neither model \" + \"topology or manifest for weights.\");\n                        }\n                        if (!(weightsManifest != null)) return [3, 4];\n                        weightsManifest_1 = modelConfig['weightsManifest'];\n                        weightSpecs = [];\n                        for (_i = 0, weightsManifest_2 = weightsManifest_1; _i < weightsManifest_2.length; _i++) {\n                            entry = weightsManifest_2[_i];\n                            weightSpecs.push.apply(weightSpecs, entry.weights);\n                        }\n                        pathPrefix_1 = this.path.substring(0, this.path.lastIndexOf('/'));\n                        if (!pathPrefix_1.endsWith('/')) {\n                            pathPrefix_1 = pathPrefix_1 + '/';\n                        }\n                        fetchURLs_1 = [];\n                        weightsManifest_1.forEach(function (weightsGroup) {\n                            weightsGroup.paths.forEach(function (path) {\n                                fetchURLs_1.push(pathPrefix_1 + path);\n                            });\n                        });\n                        _a = _io_utils.concatenateArrayBuffers;\n                        return [4, (0, _weights_loader.loadWeightsAsArrayBuffer)(fetchURLs_1, this.requestInit)];\n                    case 3:\n                        weightData = _a.apply(void 0, [_b.sent()]);\n                        _b.label = 4;\n                    case 4:\n                        return [2, { modelTopology: modelTopology, weightSpecs: weightSpecs, weightData: weightData }];\n                }\n            });\n        });\n    };\n    BrowserHTTPRequest.URL_SCHEMES = ['http://', 'https://'];\n    return BrowserHTTPRequest;\n}();\nexports.BrowserHTTPRequest = BrowserHTTPRequest;\nvar httpRequestRouter = exports.httpRequestRouter = function (url) {\n    if (!_environment.ENV.get('IS_BROWSER')) {\n        return null;\n    } else {\n        for (var _i = 0, _a = BrowserHTTPRequest.URL_SCHEMES; _i < _a.length; _i++) {\n            var scheme = _a[_i];\n            if (url.startsWith(scheme)) {\n                return browserHTTPRequest(url);\n            }\n        }\n        return null;\n    }\n};\n_router_registry.IORouterRegistry.registerSaveRouter(httpRequestRouter);\n_router_registry.IORouterRegistry.registerLoadRouter(httpRequestRouter);\nfunction browserHTTPRequest(path, requestInit) {\n    return new BrowserHTTPRequest(path, requestInit);\n}\n//# sourceMappingURL=browser_http.js.map"},"hash":"d55d905600ff566a9e47f9347b4da303","cacheData":{"env":{}}}