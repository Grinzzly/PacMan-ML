{"dependencies":[{"name":"/home/szamulko/Desktop/Projects/PacMan/package.json","includedInParent":true,"mtime":1528724217926},{"name":"/home/szamulko/Desktop/Projects/PacMan/node_modules/@tensorflow/tfjs-core/package.json","includedInParent":true,"mtime":1528724212618},{"name":"../doc","loc":{"line":42,"column":20}},{"name":"../util","loc":{"line":43,"column":23}},{"name":"./router_registry","loc":{"line":44,"column":33}}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ModelManagement = exports.ModelStoreManagerRegistry = undefined;\n\nvar _doc = require(\"../doc\");\n\nvar _util = require(\"../util\");\n\nvar _router_registry = require(\"./router_registry\");\n\nvar __decorate = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n    var c = arguments.length,\n        r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n        d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = undefined && undefined.__awaiter || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n            try {\n                step(generator.next(value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function rejected(value) {\n            try {\n                step(generator[\"throw\"](value));\n            } catch (e) {\n                reject(e);\n            }\n        }\n        function step(result) {\n            result.done ? resolve(result.value) : new P(function (resolve) {\n                resolve(result.value);\n            }).then(fulfilled, rejected);\n        }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = undefined && undefined.__generator || function (thisArg, body) {\n    var _ = { label: 0, sent: function () {\n            if (t[0] & 1) throw t[1];return t[1];\n        }, trys: [], ops: [] },\n        f,\n        y,\n        t,\n        g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n    }), g;\n    function verb(n) {\n        return function (v) {\n            return step([n, v]);\n        };\n    }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0:case 1:\n                    t = op;break;\n                case 4:\n                    _.label++;return { value: op[1], done: false };\n                case 5:\n                    _.label++;y = op[1];op = [0];continue;\n                case 7:\n                    op = _.ops.pop();_.trys.pop();continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                        _ = 0;continue;\n                    }\n                    if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                        _.label = op[1];break;\n                    }\n                    if (op[0] === 6 && _.label < t[1]) {\n                        _.label = t[1];t = op;break;\n                    }\n                    if (t && _.label < t[2]) {\n                        _.label = t[2];_.ops.push(op);break;\n                    }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop();continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) {\n            op = [6, e];y = 0;\n        } finally {\n            f = t = 0;\n        }\n        if (op[0] & 5) throw op[1];return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n\nvar URL_SCHEME_SUFFIX = '://';\nvar ModelStoreManagerRegistry = function () {\n    function ModelStoreManagerRegistry() {\n        this.managers = {};\n    }\n    ModelStoreManagerRegistry.getInstance = function () {\n        if (ModelStoreManagerRegistry.instance == null) {\n            ModelStoreManagerRegistry.instance = new ModelStoreManagerRegistry();\n        }\n        return ModelStoreManagerRegistry.instance;\n    };\n    ModelStoreManagerRegistry.registerManager = function (scheme, manager) {\n        (0, _util.assert)(scheme != null, 'scheme must not be undefined or null.');\n        if (scheme.endsWith(URL_SCHEME_SUFFIX)) {\n            scheme = scheme.slice(0, scheme.indexOf(URL_SCHEME_SUFFIX));\n        }\n        (0, _util.assert)(scheme.length > 0, 'scheme must not be an empty string.');\n        var registry = ModelStoreManagerRegistry.getInstance();\n        (0, _util.assert)(registry.managers[scheme] == null, \"A model store manager is already registered for scheme '\" + scheme + \"'.\");\n        registry.managers[scheme] = manager;\n    };\n    ModelStoreManagerRegistry.getManager = function (scheme) {\n        var manager = this.getInstance().managers[scheme];\n        if (manager == null) {\n            throw new Error(\"Cannot find model manager for scheme '\" + scheme + \"'\");\n        }\n        return manager;\n    };\n    ModelStoreManagerRegistry.getSchemes = function () {\n        return Object.keys(this.getInstance().managers);\n    };\n    return ModelStoreManagerRegistry;\n}();\nexports.ModelStoreManagerRegistry = ModelStoreManagerRegistry;\n\nfunction parseURL(url) {\n    if (url.indexOf(URL_SCHEME_SUFFIX) === -1) {\n        throw new Error(\"The url string provided does not contain a scheme. \" + \"Supported schemes are: \" + (\"\" + ModelStoreManagerRegistry.getSchemes().join(',')));\n    }\n    return {\n        scheme: url.split(URL_SCHEME_SUFFIX)[0],\n        path: url.split(URL_SCHEME_SUFFIX)[1]\n    };\n}\nfunction cloneModelInternal(sourceURL, destURL, deleteSource) {\n    if (deleteSource === void 0) {\n        deleteSource = false;\n    }\n    return __awaiter(this, void 0, void 0, function () {\n        var loadHandlers, loadHandler, saveHandlers, saveHandler, sourceScheme, sourcePath, sameMedium, modelArtifacts, saveResult;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    (0, _util.assert)(sourceURL !== destURL, \"Old path and new path are the same: '\" + sourceURL + \"'\");\n                    loadHandlers = _router_registry.IORouterRegistry.getLoadHandlers(sourceURL);\n                    (0, _util.assert)(loadHandlers.length > 0, \"Copying failed because no load handler is found for source URL \" + sourceURL + \".\");\n                    (0, _util.assert)(loadHandlers.length < 2, \"Copying failed because more than one (\" + loadHandlers.length + \") \" + (\"load handlers for source URL \" + sourceURL + \".\"));\n                    loadHandler = loadHandlers[0];\n                    saveHandlers = _router_registry.IORouterRegistry.getSaveHandlers(destURL);\n                    (0, _util.assert)(saveHandlers.length > 0, \"Copying failed because no save handler is found for destination URL \" + (destURL + \".\"));\n                    (0, _util.assert)(saveHandlers.length < 2, \"Copying failed because more than one (\" + loadHandlers.length + \") \" + (\"save handlers for destination URL \" + destURL + \".\"));\n                    saveHandler = saveHandlers[0];\n                    sourceScheme = parseURL(sourceURL).scheme;\n                    sourcePath = parseURL(sourceURL).path;\n                    sameMedium = sourceScheme === parseURL(sourceURL).scheme;\n                    return [4, loadHandler.load()];\n                case 1:\n                    modelArtifacts = _a.sent();\n                    if (!(deleteSource && sameMedium)) return [3, 3];\n                    return [4, ModelStoreManagerRegistry.getManager(sourceScheme).removeModel(sourcePath)];\n                case 2:\n                    _a.sent();\n                    _a.label = 3;\n                case 3:\n                    return [4, saveHandler.save(modelArtifacts)];\n                case 4:\n                    saveResult = _a.sent();\n                    if (!(deleteSource && !sameMedium)) return [3, 6];\n                    return [4, ModelStoreManagerRegistry.getManager(sourceScheme).removeModel(sourcePath)];\n                case 5:\n                    _a.sent();\n                    _a.label = 6;\n                case 6:\n                    return [2, saveResult.modelArtifactsInfo];\n            }\n        });\n    });\n}\nvar ModelManagement = function () {\n    function ModelManagement() {}\n    ModelManagement.listModels = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var schemes, out, _i, schemes_1, scheme, schemeOut, path, url;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        schemes = ModelStoreManagerRegistry.getSchemes();\n                        out = {};\n                        _i = 0, schemes_1 = schemes;\n                        _a.label = 1;\n                    case 1:\n                        if (!(_i < schemes_1.length)) return [3, 4];\n                        scheme = schemes_1[_i];\n                        return [4, ModelStoreManagerRegistry.getManager(scheme).listModels()];\n                    case 2:\n                        schemeOut = _a.sent();\n                        for (path in schemeOut) {\n                            url = scheme + URL_SCHEME_SUFFIX + path;\n                            out[url] = schemeOut[path];\n                        }\n                        _a.label = 3;\n                    case 3:\n                        _i++;\n                        return [3, 1];\n                    case 4:\n                        return [2, out];\n                }\n            });\n        });\n    };\n    ModelManagement.removeModel = function (url) {\n        return __awaiter(this, void 0, void 0, function () {\n            var schemeAndPath, manager;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        schemeAndPath = parseURL(url);\n                        manager = ModelStoreManagerRegistry.getManager(schemeAndPath.scheme);\n                        return [4, manager.removeModel(schemeAndPath.path)];\n                    case 1:\n                        return [2, _a.sent()];\n                }\n            });\n        });\n    };\n    ModelManagement.copyModel = function (sourceURL, destURL) {\n        return __awaiter(this, void 0, void 0, function () {\n            var deleteSource;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        deleteSource = false;\n                        return [4, cloneModelInternal(sourceURL, destURL, deleteSource)];\n                    case 1:\n                        return [2, _a.sent()];\n                }\n            });\n        });\n    };\n    ModelManagement.moveModel = function (sourceURL, destURL) {\n        return __awaiter(this, void 0, void 0, function () {\n            var deleteSource;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        deleteSource = true;\n                        return [4, cloneModelInternal(sourceURL, destURL, deleteSource)];\n                    case 1:\n                        return [2, _a.sent()];\n                }\n            });\n        });\n    };\n    __decorate([(0, _doc.doc)({ heading: 'Models', subheading: 'Management', namespace: 'io' })], ModelManagement, \"listModels\", null);\n    __decorate([(0, _doc.doc)({ heading: 'Models', subheading: 'Management', namespace: 'io' })], ModelManagement, \"removeModel\", null);\n    __decorate([(0, _doc.doc)({ heading: 'Models', subheading: 'Management', namespace: 'io' })], ModelManagement, \"copyModel\", null);\n    __decorate([(0, _doc.doc)({ heading: 'Models', subheading: 'Management', namespace: 'io' })], ModelManagement, \"moveModel\", null);\n    return ModelManagement;\n}();\nexports.ModelManagement = ModelManagement;\n//# sourceMappingURL=model_management.js.map"},"hash":"f0ff378e41c3ff5cd29e8bbfc833042e","cacheData":{"env":{}}}